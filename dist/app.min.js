const i="production",n=`.env.${i}`;c.config({path:`${n}`});import r,{urlencoded as m}from"express";import p from"cors";import c from"dotenv";import u from"morgan";import{routeSkills as l}from"./routes/route.skill.js";import d from"helmet";import{routeProfile as f}from"./routes/route.profile.js";import{dirname as g,join as v}from"path";import{fileURLToPath as E}from"url";import{routeFocus as O}from"./routes/routeFocus.js";import{routeProjects as A}from"./routes/route.project.js";import{routeStudies as R}from"./routes/route.studies.js";import{routeTrajectory as _}from"./routes/route.trajectory.js";import h from"./routes/route.contact.js";import C from"./model/model.relayConnection.js";const S=E(import.meta.url),T=g(S),e=r(),s=process.env.PORT||3e3,N=`${process.env.MESSAGE_CONNECTION_SERVER} ${s}`;e.set("port",s),e.set("message_server",N),e.use(d({crossOriginResourcePolicy:{policy:"cross-origin"}})),e.use(p({origin:process.env.ORIGIN,credentials:!0})),e.use((t,o,a)=>{o.header("Access-Control-Allow-Origin",`${process.env.ORIGIN}`),o.header("Access-Control-Allow-Methods","GET, POST"),o.header("Access-Control-Allow-Headers","Content-Type, Authorization"),a()}),e.use(u("dev")),e.use(r.json()),e.use(m({extended:!0})),e.use("/uploads",r.static(v(T,"images","uploads"))),setInterval(async()=>{await C()},3e5),e.use("/api/data",l),e.use("/api/data",f),e.use("/api/data",O),e.use("/api/data",A),e.use("/api/data",R),e.use("/api/data",_),e.use("/api/data",h),e.use((t,o)=>{o.status(404).json({success:!1,message:"Ruta no encontrada."})}),e.listen(e.get("port"),console.log(e.get("message_server")));
